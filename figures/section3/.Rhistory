get_confset <- function(vec){
quantile(vec, probs = c(0.025, 0.5,0.975));
}
get_mean_sd <- function(vec){
c(mean(vec), sd(vec));
}
get_confset(pmcmc_param_chain_dgpinit[nburn : nmcmc, 4])
get_mean_sd(pmcmc_param_chain_dgpinit[nburn : nmcmc, 4]))
get_confset(pmcmc_param_chain_dgpinit[nburn : nmcmc, 4])
get_mean_sd(pmcmc_param_chain_dgpinit[nburn : nmcmc, 4])
get_confset(pmcmc_param_chain_dgpinit[nburn : nmcmc, 4])
get_mean_sd(pmcmc_param_chain_dgpinit[nburn : nmcmc, 4])
get_confset(pmcmc_param_chain_dgpinit[nburn : nmcmc, 4])
get_mean_sd(pmcmc_param_chain_dgpinit[nburn : nmcmc, 4])
get_mean_sd(pmcmc_param_chain_dgpinit[nburn : nmcmc, 4])
get_confset(pmcmc_param_chain_dgpinit[nburn : nmcmc, 4])
get_mean_sd(pmcmc_param_chain_dgpinit[nburn : nmcmc, 4])
get_confset(pmcmc_param_chain_dgpinit[nburn : nmcmc, 7])
c(mean(vec)- sd(vec), mean(vec), mean(vec) + sd(vec));
get_mean_sd <- function(vec){
c(mean(vec)- sd(vec), mean(vec), mean(vec) + sd(vec));
}
get_confset(pmcmc_param_chain_dgpinit[nburn : nmcmc, 4])
get_mean_sd(pmcmc_param_chain_dgpinit[nburn : nmcmc, 4])
get_mean_sd <- function(vec){
c(mean(vec) -  sd(vec), mean(vec), mean(vec) + sd(vec));
}
get_confset(pmcmc_param_chain_dgpinit[nburn : nmcmc, 4])
get_mean_sd(pmcmc_param_chain_dgpinit[nburn : nmcmc, 4])
quantile(vec, probs = c(0.025, 0.5,0.975));
get_confset <- function(vec){
quantile(vec, probs = c(0.025, 0.5,0.975));
}
get_mean_sd <- function(vec){
c(mean(vec) - 2 *  sd(vec), mean(vec), mean(vec) + 2 * sd(vec));
}
get_confset(pmcmc_param_chain_dgpinit[nburn : nmcmc, 4])
get_mean_sd(pmcmc_param_chain_dgpinit[nburn : nmcmc, 4])
get_confset(pmcmc_param_chain_dgpinit[nburn : nmcmc, 7])
get_mean_sd(pmcmc_param_chain_dgpinit[nburn : nmcmc, 7])
expit <- function(x) 1 / (1 + exp(-x));
quantile(expit(smallset[,3])/ expit(smallset[,5]), probs = c(0.025,0.5,0.975), na.rm = TRUE)
get_mean_sd(expit(smallset[,3])/ expit(smallset[,5]))
get_mean_sd <- function(vec){
vec <- vec[-is.na(vec)]
c(mean(vec) - 2 *  sd(vec), mean(vec), mean(vec) + 2 * sd(vec));
}
get_mean_sd(expit(smallset[,3])/ expit(smallset[,5]))
get_mean_sd(expit(smallset[,3])/ expit(smallset[,5]))
get_mean_sd <- function(vec){
vec <- vec[-is.na(vec)];
c(mean(vec) - 2 *  sd(vec), mean(vec), mean(vec) + 2 * sd(vec));
}
get_confset(pmcmc_param_chain_dgpinit[nburn : nmcmc, 4])
get_mean_sd(pmcmc_param_chain_dgpinit[nburn : nmcmc, 4])
get_mean_sd <- function(vec){
vec <- vec[-is.na(vec)];
c(mean(vec) - 2 *  sd(vec), mean(vec), mean(vec) + 2 * sd(vec));
}
get_confset(pmcmc_param_chain_dgpinit[nburn : nmcmc, 4])
get_mean_sd(pmcmc_param_chain_dgpinit[nburn : nmcmc, 4])
is.na(1)
get_mean_sd <- function(vec){
vec <- vec[!is.na(vec)];
c(mean(vec) - 2 *  sd(vec), mean(vec), mean(vec) + 2 * sd(vec));
}
get_confset(pmcmc_param_chain_dgpinit[nburn : nmcmc, 4])
get_mean_sd(pmcmc_param_chain_dgpinit[nburn : nmcmc, 4])
expit <- function(x) 1 / (1 + exp(-x));
quantile(expit(smallset[,3])/ expit(smallset[,5]), probs = c(0.025,0.5,0.975), na.rm = TRUE)
get_mean_sd(expit(smallset[,3])/ expit(smallset[,5]))
get_confset(pmcmc_param_chain_dgpinit[nburn : nmcmc, 7])
get_confset(pmcmc_param_chain_dgpinit[nburn : nmcmc, 4])
dgp_parameters[4]
dnorm(3, mean = 0, sd = 3, log = TRUE)
dnorm(3, mean = 0, sd = 3, log = TRUE) * 6
hist(expit(smallset[,3]) / expit(smallset[,5]))
summary(expit(smallset[,3]) / expit(smallset[,5]))
summary(expit(smallset[,5]))
summary(smallset[,5])
summary(smallset)
head(smallset)
hist(smallset$bg1)
summary(smallset$bg1)
tail(smallset$bg1)
knitr::opts_chunk$set(echo = TRUE)
rm(list = ls());
library(ggplot2);
library(ggExtra);
library(gridExtra);
load("data_run_gibbs.RData");
singlesite_accept_chain_dgpinit <- accept_chain;
singlesite_lpost_chain_dgpinit <- lpost_chain;
singlesite_param_chain_dgpinit <- chain;
load("data_run_block_gibbs.RData");
block_accept_chain_dgpinit <- accept_chain;
block_lpost_chain_dgpinit <- lpost_chain;
block_param_chain_dgpinit <- chain;
load("data_run_pmcmc_final.RData");
pmcmc_accept_chain_dgpinit <- accept_chain;
pmcmc_lpost_chain_dgpinit <- lpost_chain;
pmcmc_param_chain_dgpinit <- chain;
load("data_run_pmcmc_randominitial.RData");
pmcmc_accept_chain_randinit <- accept_chain;
pmcmc_lpost_chain_randinit <- lpost_chain;
pmcmc_param_chain_randinit <- chain;
load("data_run_gibbs_randominit.RData");
singlesite_accept_chain_randinit <- accept_chain;
singlesite_lpost_chain_randinit <- lpost_chain;
singlesite_param_chain_randinit <- chain;
load("data_run_block_gibbs_randominit.RData");
block_accept_chain_randinit <- accept_chain;
block_lpost_chain_randinit <- lpost_chain;
block_param_chain_randinit <- chain;
load("data_run_block_gibbs_badinit.RData");
block_accept_chain_tailinit <- accept_chain;
block_lpost_chain_tailinit <- lpost_chain;
block_param_chain_tailinit <- chain;
nburn <- burn_in;
nmcmc <- num_mcmc;
set.seed(2020);
rand_init_param <- c(rnorm(6,  sd = 3), runif(1)); ### RANDOM INIT
tail_init_param <- c(-10,4,-6,6,6,6,0.95); ## a bad point
pmcmc_dgp_df <- data.frame(pmcmc_param_chain_dgpinit[nburn : nmcmc,]);
names(pmcmc_dgp_df) <- c("b01","b02","bl1","bl2","bg1","bg2","rho");
pmcmc_dgp_df$method <- "pmcmc"
pmcmc_dgp_df$init <- "dgp"
singlesite_dgp_df <- data.frame(singlesite_param_chain_dgpinit[nburn : nmcmc,]);
names(singlesite_dgp_df) <- c("b01","b02","bl1","bl2","bg1","bg2","rho");
singlesite_dgp_df$method <- "singlesite"
singlesite_dgp_df$init <- "dgp"
block_dgp_df <- data.frame(block_param_chain_dgpinit[nburn : nmcmc,]);
names(block_dgp_df) <- c("b01","b02","bl1","bl2","bg1","bg2","rho");
block_dgp_df$method <- "block5"
block_dgp_df$init <- "dgp"
pmcmc_rand_df <- data.frame(pmcmc_param_chain_randinit[nburn : nmcmc,]);
names(pmcmc_rand_df) <- c("b01","b02","bl1","bl2","bg1","bg2","rho");
pmcmc_rand_df$method <- "pmcmc"
pmcmc_rand_df$init <- "random"
singlesite_rand_df <- data.frame(singlesite_param_chain_randinit[nburn : nmcmc,]);
names(singlesite_rand_df) <- c("b01","b02","bl1","bl2","bg1","bg2","rho");
singlesite_rand_df$method <- "singlesite"
singlesite_rand_df$init <- "random"
block_rand_df <- data.frame(block_param_chain_randinit[nburn : nmcmc,]);
names(block_rand_df) <- c("b01","b02","bl1","bl2","bg1","bg2","rho");
block_rand_df$method <- "block5"
block_rand_df$init <- "random"
block_tail_df <- data.frame(block_param_chain_tailinit[nburn : nmcmc,]);
names(block_tail_df) <- c("b01","b02","bl1","bl2","bg1","bg2","rho");
block_tail_df$method <- "block5"
block_tail_df$init <- "tail"
df <- rbind(pmcmc_dgp_df, singlesite_dgp_df, block_dgp_df,
pmcmc_rand_df, singlesite_rand_df, block_rand_df,
block_tail_df);
accept_probability <- double(6);
accept_probability[1] <- mean(pmcmc_accept_chain_dgpinit);
accept_probability[2] <- mean(singlesite_accept_chain_dgpinit);
accept_probability[3] <- mean(block_accept_chain_dgpinit);
accept_probability[4] <- mean(pmcmc_accept_chain_randinit);
accept_probability[5] <- mean(singlesite_accept_chain_randinit);
accept_probability[6] <- mean(block_accept_chain_randinit);
names(accept_probability) <- c("pmcmc_dgp", "singlesite_dgp", "block5_dgp", "pmcmc_rand", "singlesite_rand","block5_rand");
print(accept_probability, digits = 6);
post_mean <- data.frame(method = factor(character(8), levels = c("dgp","pmcmc_dgp", "singlesite_dgp", "block5_dgp", "pmcmc_rand", "singlesite_rand", "block5_rand","block5_tail")), b01 = double(8), b02 = double(8), bl1 = double(8), bl2 = double(8), bg1 = double(8), bg2 = double(8), rho = double(8));
post_mean[1,] <- c("dgp",dgp_parameters);
post_mean[2,] <- c("pmcmc_dgp", colMeans(pmcmc_param_chain_dgpinit[nburn : nmcmc,]));
post_mean[3,] <- c("singlesite_dgp", colMeans(singlesite_param_chain_dgpinit[nburn : nmcmc,]));
post_mean[4,] <- c("block5_dgp", colMeans(block_param_chain_dgpinit[nburn : nmcmc,]));
post_mean[5,] <- c("pmcmc_rand", colMeans(pmcmc_param_chain_randinit[nburn: nmcmc, ]));
post_mean[6, ] <- c("singlesite_rand", colMeans(singlesite_param_chain_randinit[nburn : nmcmc, ]));
post_mean[7, ] <- c("block5_rand", colMeans(block_param_chain_randinit[nburn : nmcmc, ]));
post_mean[8, ] <- c("block5_tail", colMeans(block_param_chain_tailinit[nburn : nmcmc, ]));
print(post_mean, digits = 4);
hist_b01 <- ggplot(df, aes(x = b01)) +
geom_histogram(aes( y = ..density..), color="#e9ecef", alpha=0.6, position = 'identity', bins = 30) +
geom_density(alpha = 0.2) +
geom_vline(xintercept = dgp_parameters[1], col = "red") +
geom_vline(xintercept = rand_init_param[1], col = "blue") +
geom_vline(xintercept = tail_init_param[1], col = "yellow") +
facet_grid(rows = vars(method), cols = vars(init)) + theme_bw();
hist_b02 <- ggplot(df, aes(x = b02)) +
geom_histogram(aes( y = ..density..), color="#e9ecef", alpha=0.6, position = 'identity', bins = 30) +
geom_density(alpha = 0.2) +
geom_vline(xintercept = dgp_parameters[2], col = "red") +
geom_vline(xintercept = rand_init_param[2], col = "blue") +
geom_vline(xintercept = tail_init_param[2], col = "yellow") +
facet_grid(rows = vars(method), cols = vars(init)) + theme_bw();
gridExtra::grid.arrange(hist_b01, hist_b02, ncol = 2);
hist_bl1 <- ggplot(df, aes(x = bl1)) +
geom_histogram(aes( y = ..density..), color="#e9ecef", alpha=0.6, position = 'identity', bins = 30) +
geom_density(alpha = 0.2) +
geom_vline(xintercept = dgp_parameters[3], col = "red") +
geom_vline(xintercept = rand_init_param[3], col = "blue") +
geom_vline(xintercept = tail_init_param[3], col = "yellow") +
facet_grid(rows = vars(method), cols = vars(init)) + theme_bw();
hist_bl2 <- ggplot(df, aes(x = bl2)) +
geom_histogram(aes( y = ..density..), color="#e9ecef", alpha=0.6, position = 'identity', bins = 30) +
geom_density(alpha = 0.2) +
geom_vline(xintercept = dgp_parameters[4], col = "red") +
geom_vline(xintercept = rand_init_param[4], col = "blue") +
geom_vline(xintercept = tail_init_param[4], col = "yellow") +
facet_grid(rows = vars(method), cols = vars(init)) + theme_bw();
gridExtra::grid.arrange(hist_bl1, hist_bl2, ncol = 2);
hist_bg1 <- ggplot(df, aes(x = bg1)) +
geom_histogram(aes( y = ..density..), color="#e9ecef", alpha=0.6, position = 'identity', bins = 30) +
geom_density(alpha = 0.2) +
geom_vline(xintercept = dgp_parameters[5], col = "red") +
geom_vline(xintercept = rand_init_param[5], col = "blue") +
geom_vline(xintercept = tail_init_param[5], col = "yellow") +
facet_grid(rows = vars(method), cols = vars(init)) + theme_bw();
hist_bg2 <- ggplot(df, aes(x = bg2)) +
geom_histogram(aes( y = ..density..), color="#e9ecef", alpha=0.6, position = 'identity', bins = 30) +
geom_density(alpha = 0.2) +
geom_vline(xintercept = dgp_parameters[6], col = "red") +
geom_vline(xintercept = rand_init_param[6], col = "blue") +
geom_vline(xintercept = tail_init_param[6], col = "yellow") +
facet_grid(rows = vars(method), cols = vars(init)) + theme_bw();
gridExtra::grid.arrange(hist_bg1, hist_bg2, ncol = 2);
hist_rho <- ggplot(df, aes(x = rho)) +
geom_histogram(aes( y = ..density..), color="#e9ecef", alpha=0.6, position = 'identity', bins = 30) +
geom_density(alpha = 0.2) +
geom_vline(xintercept = dgp_parameters[7], col = "red") +
geom_vline(xintercept = rand_init_param[7], col = "blue") +
geom_vline(xintercept = tail_init_param[7], col = "yellow") +
facet_grid(rows = vars(method), cols = vars(init)) + theme_bw();
hist_rho;
acf_df <- data.frame();
for(iparameter in 1 : 7){
acf_df <- rbind(acf_df, data.frame(method = "pmcmc", init = "dgp", lag = c(1,5,25,75,100), parameter = names(singlesite_dgp_df)[iparameter], autocorr = acf(pmcmc_param_chain_dgpinit[nburn : nmcmc, iparameter], lag.max = 100, plot = F)$acf[1 + c(1,5,25,75,100)]));
acf_df <- rbind(acf_df, data.frame(method = "singlesite", init = "dgp", lag = c(1,5,25,75,100), parameter = names(singlesite_dgp_df)[iparameter], autocorr = acf(singlesite_param_chain_dgpinit[nburn : nmcmc, iparameter], lag.max = 100, plot = F)$acf[1 + c(1,5,25,75,100)]));
acf_df <- rbind(acf_df, data.frame(method = "block5", init = "dgp", lag = c(1,5,25,75,100),parameter = names(singlesite_dgp_df)[iparameter], autocorr = acf(block_param_chain_dgpinit[nburn : nmcmc, iparameter], lag.max = 100, plot = F)$acf[1 + c(1,5,25,75,100)]));
acf_df <- rbind(acf_df, data.frame(method = "pmcmc",init = "random", lag = c(1,5,25,75,100), parameter = names(singlesite_rand_df)[iparameter], autocorr = acf(pmcmc_param_chain_randinit[nburn : nmcmc, iparameter], lag.max = 100, plot = F)$acf[1 + c(1,5,25,75,100)]));
acf_df <- rbind(acf_df, data.frame(method = "singlesite", init = "random",lag = c(1,5,25,75,100), parameter = names(singlesite_rand_df)[iparameter], autocorr = acf(singlesite_param_chain_randinit[nburn : nmcmc, iparameter], lag.max = 100, plot = F)$acf[1 + c(1,5,25,75,100)]));
acf_df <- rbind(acf_df, data.frame(method = "block5", init = "random",lag = c(1,5,25,75,100),parameter = names(singlesite_rand_df)[iparameter], autocorr = acf(block_param_chain_randinit[nburn : nmcmc, iparameter], lag.max = 100, plot = F)$acf[1 + c(1,5,25,75,100)]));
}
acf_df$method <- factor(acf_df$method);
acf_df$parameter <- factor(acf_df$parameter);
acf_df$init <- factor(acf_df$init);
p_acf <- ggplot(acf_df, aes(x = lag, y = autocorr)) + geom_line(aes(linetype = init, colour = method))  + facet_wrap(vars(parameter)) + theme_bw() + theme(legend.position = "bottom") ;
p_acf
thining_index <- seq(from = 1, to = nmcmc  - 10000 - nburn + 1, by = 50);
pmcmc_dgp_df_thin <- pmcmc_dgp_df[thining_index, ];
pmcmc_dgp_df_thin$index <- thining_index;
pmcmc_dgp_df_thin$method <- "pmcmc"
pmcmc_dgp_df_thin$init <- "dgp"
singlesite_dgp_df_thin <- singlesite_dgp_df[thining_index, ];
singlesite_dgp_df_thin$index <- thining_index;
singlesite_dgp_df_thin$method <- "singlesite"
singlesite_dgp_df_thin$init <- "dgp"
block_dgp_df_thin <- block_dgp_df[thining_index, ];
block_dgp_df_thin$index <- thining_index;
block_dgp_df_thin$method <- "block5"
pmcmc_rand_df_thin <- pmcmc_rand_df[thining_index,];
pmcmc_rand_df_thin$index <- thining_index;
pmcmc_rand_df_thin$method <- "pmcmc";
pmcmc_rand_df_thin$init <- "random";
singlesite_rand_df_thin <- singlesite_rand_df[thining_index,];
singlesite_rand_df_thin$index <- thining_index;
singlesite_rand_df_thin$method <- "singlesite";
singlesite_rand_df_thin$init <- "random"
block_rand_df_thin <- block_rand_df[thining_index,];
block_rand_df_thin$index <- thining_index;
block_rand_df_thin$method <- "block5";
block_rand_df_thin$init <- "random"
smallset <- rbind(pmcmc_dgp_df_thin, singlesite_dgp_df_thin, block_dgp_df_thin,
pmcmc_rand_df_thin,
singlesite_rand_df_thin, block_rand_df_thin);
smallset$method <- factor(smallset$method);
p_corr_bo <- ggplot(smallset, aes(x=b01, y= b02, col = index)) + geom_point() + geom_hline(yintercept = dgp_parameters[2], col = "red") +
geom_vline(xintercept = dgp_parameters[1], col = "red") + scale_color_gradient(low = "yellow", high = "black") +
geom_hline(yintercept = rand_init_param[2], col = "blue") +
geom_vline(xintercept = rand_init_param[1], col = "blue") +
facet_grid(rows = vars(method), cols = vars(init)) +  theme_bw() + theme(legend.position="none");
p_corr_bo
p_corr_bl <- ggplot(smallset, aes(x=bl1, y= bl2, col = index)) + geom_point() + geom_hline(yintercept = dgp_bl2, col = "red") +
geom_vline(xintercept = dgp_bl1, col = "red") + scale_color_gradient(low = "yellow", high = "black") +
geom_hline(yintercept = rand_init_param[4], col = "blue") +
geom_vline(xintercept = rand_init_param[3], col = "blue") +
facet_grid(rows = vars(method), cols = vars(init)) +  theme_bw() + theme(legend.position="none");
p_corr_bl
pmcmc_dgp_corr_bl <- cor(pmcmc_dgp_df$bl1, pmcmc_dgp_df$bl2);
singlesite_dgp_corr_bl <- cor(singlesite_dgp_df$bl1, singlesite_dgp_df$bl2);
block_dgp_corr_bl <- cor(block_dgp_df$bl1, block_dgp_df$bl2);
singlesite_rand_corr_bl <- cor(singlesite_rand_df$bl1, singlesite_rand_df$bl2);
block_rand_corr_bl <- cor(block_rand_df$bl1, block_rand_df$bl2);
cat("[the correlation between beta-lambda-1&2 is:", pmcmc_dgp_corr_bl, singlesite_dgp_corr_bl, block_dgp_corr_bl,
singlesite_rand_corr_bl, block_rand_corr_bl, "]");
p_corr_bg <- ggplot(smallset, aes(x=bg1, y= bg2, col = index)) + geom_point() + geom_hline(yintercept = dgp_bg2, col = "red") +
geom_vline(xintercept = dgp_bg1, col = "red") + scale_color_gradient(low = "yellow", high = "black") +
geom_hline(yintercept = rand_init_param[6], col = "blue") +
geom_vline(xintercept = rand_init_param[5], col = "blue") +
facet_grid(rows = vars(method), cols = vars(init)) +  theme_bw() + theme(legend.position="none");
p_corr_bg
p_corr_blg1 <- ggplot(smallset, aes(x=bl1, y= bg1, col = index)) + geom_point() + geom_hline(yintercept = dgp_bg1, col = "red") +
geom_vline(xintercept = dgp_bl1, col = "red") + scale_color_gradient(low = "yellow", high = "black") +
geom_hline(yintercept = rand_init_param[5], col = "blue") +
geom_vline(xintercept = rand_init_param[3], col = "blue") +
facet_grid(rows = vars(method), cols = vars(init)) +  theme_bw() + theme(legend.position="none");
p_corr_blg1
p_corr_blg2 <- ggplot(smallset, aes(x=bl2, y= bg2, col = index)) + geom_point() + geom_hline(yintercept = dgp_bg2, col = "red") +
geom_vline(xintercept = dgp_bl2, col = "red") + scale_color_gradient(low = "yellow", high = "black") +
geom_hline(yintercept = rand_init_param[6], col = "blue") +
geom_vline(xintercept = rand_init_param[4], col = "blue") +
facet_grid(rows = vars(method), cols = vars(init)) +  theme_bw() + theme(legend.position="none");
p_corr_blg2
p_corr_blr <- ggplot(smallset, aes(x=bl1, y= rho, col = index)) + geom_point() + geom_hline(yintercept = dgp_parameters[7], col = "red") +
geom_vline(xintercept = dgp_bl1, col = "red") + scale_color_gradient(low = "yellow", high = "black") +
geom_hline(yintercept = rand_init_param[7], col = "blue") +
geom_vline(xintercept = rand_init_param[3], col = "blue") +
facet_grid(rows = vars(method), cols = vars(init)) +  theme_bw() + theme(legend.position="none");
p_corr_blr
pmcmc_dgp_corr_blr <- cor(pmcmc_dgp_df$bl1, pmcmc_dgp_df$rho);
singlesite_dgp_corr_blr <- cor(singlesite_dgp_df$bl1, singlesite_dgp_df$rho);
block_dgp_corr_blr <- cor(block_dgp_df$bl1, block_dgp_df$rho);
pmcmc_rand_corr_blr <- cor(pmcmc_rand_df$bl1, pmcmc_rand_df$rho);
singlesite_rand_corr_blr <- cor(singlesite_rand_df$bl1, singlesite_rand_df$rho);
block_rand_corr_blr <- cor(block_rand_df$bl1, block_rand_df$rho);
cat("[the correlation between beta-lambda-1 and rho is:", pmcmc_dgp_corr_blr, singlesite_dgp_corr_blr, block_dgp_corr_blr,
pmcmc_rand_corr_blr, singlesite_rand_corr_blr, block_rand_corr_blr,
"]");
get_confset <- function(vec){
quantile(vec, probs = c(0.025, 0.5,0.975));
}
get_mean_sd <- function(vec){
vec <- vec[!is.na(vec)];
c(mean(vec) - 2 *  sd(vec), mean(vec), mean(vec) + 2 * sd(vec));
}
get_confset(pmcmc_param_chain_dgpinit[nburn : nmcmc, 4])
get_mean_sd(pmcmc_param_chain_dgpinit[nburn : nmcmc, 4])
get_confset(pmcmc_param_chain_dgpinit[nburn : nmcmc, 7])
get_mean_sd(pmcmc_param_chain_dgpinit[nburn : nmcmc, 7])
expit <- function(x) 1 / (1 + exp(-x));
quantile(expit(smallset[,3])/ expit(smallset[,5]), probs = c(0.025,0.5,0.975), na.rm = TRUE)
get_mean_sd(expit(smallset[,3])/ expit(smallset[,5]))
quantile(expit(pmcmc_param_chain_dgpinit[,3])/ expit(pmcmc_param_chain_dgpinit[,5]), probs = c(0.025,0.5,0.975))
quantile(expit(pmcmc_param_chain_dgpinit[,3])/ expit(pmcmc_param_chain_dgpinit[,5]), probs = c(0.025,0.5,0.975))
get_mean_sd(expit(pmcmc_param_chain_dgpinit[,3])/ expit(pmcmc_param_chain_dgpinit[,5]))
head(smallset)
plot(expit(bl1) ~ expit(bl2), data = subset(smallset, method = "pmcmc", init = "dgp" ))
plot(expit(bl1) ~ expit(bg1), data = subset(smallset, method = "pmcmc", init = "dgp" ))
abline(a = 0, b = 1, col = "red")
plot(expit(bl1) ~ expit(bg1), data = subset(smallset, method = "pmcmc", init = "dgp" ))
abline(a = 0, b = 1, col = "red")
get_confset(pmcmc_param_chain_dgpinit[nburn : nmcmc, 7])
get_mean_sd(pmcmc_param_chain_dgpinit[nburn : nmcmc, 7])
get_confset(pmcmc_param_chain_dgpinit[nburn : nmcmc, 4])
get_mean_sd(pmcmc_param_chain_dgpinit[nburn : nmcmc, 4])
get_confset(pmcmc_param_chain_dgpinit[nburn : nmcmc, 1])
get_mean_sd(pmcmc_param_chain_dgpinit[nburn : nmcmc, 1])
get_confset(pmcmc_param_chain_dgpinit[nburn : nmcmc, 1])
get_mean_sd(pmcmc_param_chain_dgpinit[nburn : nmcmc, 1])
get_confset(pmcmc_param_chain_dgpinit[nburn : nmcmc, 1])
get_mean_sd(pmcmc_param_chain_dgpinit[nburn : nmcmc, 1])
dgp_parameters[1]
get_confset(pmcmc_param_chain_dgpinit[nburn : nmcmc, 2])
get_mean_sd(pmcmc_param_chain_dgpinit[nburn : nmcmc, 2])
get_confset(pmcmc_param_chain_dgpinit[nburn : nmcmc, 3])
get_mean_sd(pmcmc_param_chain_dgpinit[nburn : nmcmc, 3])
get_confset(pmcmc_param_chain_dgpinit[nburn : nmcmc, 3])
get_mean_sd(pmcmc_param_chain_dgpinit[nburn : nmcmc, 3])
get_confset(pmcmc_param_chain_dgpinit[nburn : nmcmc, 3])
get_mean_sd(pmcmc_param_chain_dgpinit[nburn : nmcmc, 3])
get_confset(pmcmc_param_chain_dgpinit[nburn : nmcmc, 5])
get_mean_sd(pmcmc_param_chain_dgpinit[nburn : nmcmc, 5])
get_confset(pmcmc_param_chain_dgpinit[nburn : nmcmc, 5])
get_mean_sd(pmcmc_param_chain_dgpinit[nburn : nmcmc, 5])
y
plot(y)
expit <- function(x) 1 / (1 + exp(-x));
quantile(expit(pmcmc_param_chain_dgpinit[,3])/ expit(pmcmc_param_chain_dgpinit[,5]), probs = c(0.025,0.5,0.975))
get_mean_sd(expit(pmcmc_param_chain_dgpinit[,3])/ expit(pmcmc_param_chain_dgpinit[,5]))
plot(expit(bl1) ~ expit(bg1), data = subset(smallset, method = "pmcmc", init = "dgp" ))
abline(a = 0, b = 1, col = "red")
plot(expit(bl1) ~ expit(bg1), data = subset(smallset, method = "pmcmc", init = "dgp" ))
abline(a = 0, b = 1, col = "red")
get_confset(pmcmc_param_chain_dgpinit[nburn : nmcmc, 4])
get_mean_sd(pmcmc_param_chain_dgpinit[nburn : nmcmc, 4])
get_confset(pmcmc_param_chain_dgpinit[nburn : nmcmc, 6])
get_mean_sd(pmcmc_param_chain_dgpinit[nburn : nmcmc, 6])
get_confset(pmcmc_param_chain_dgpinit[nburn : nmcmc, 6])
get_confset(pmcmc_param_chain_dgpinit[nburn : nmcmc, 6])
b <- get_lambda(parameters[3], parameters[4]);
g <- get_lambda(parameters[5], parameters[6]);
summary(apply(pmcmc_param_chain_dgpinit, 2, get_average_R0))
## get average of individual r0
get_average_R0 <- function(parameters){
b <- get_lambda(parameters[3], parameters[4]);
g <- get_lambda(parameters[5], parameters[6]);
mean(b / g)
}
summary(apply(pmcmc_param_chain_dgpinit, 2, get_average_R0))
get_average_R0(dgp_parameters)
summary(apply(pmcmc_param_chain_dgpinit, 2, get_average_R0))
get_average_R0(dgp_parameters)
head(pmcmc_param_chain_dgpinit)
get_confset(pmcmc_param_chain_dgpinit[nburn : nmcmc, 6])
summary(apply(pmcmc_param_chain_dgpinit, 1, get_average_R0))
get_average_R0(dgp_parameters)
summary(apply(pmcmc_param_chain_dgpinit, 1, get_average_R0))
summary(apply(pmcmc_param_chain_dgpinit, 1, get_average_R0))
get_average_R0(dgp_parameters)
hist(summary(apply(pmcmc_param_chain_dgpinit, 1, get_average_R0)))
## get average of individual r0
get_average_R0 <- function(parameters){
b <- get_lambda(parameters[3], parameters[4]);
g <- get_lambda(parameters[5], parameters[6]);
median(b / g)
}
summary(apply(pmcmc_param_chain_dgpinit, 1, get_average_R0))
get_average_R0(dgp_parameters)
summary(apply(pmcmc_param_chain_dgpinit, 1, get_average_R0))
get_average_R0(dgp_parameters)
hist(summary(apply(pmcmc_param_chain_dgpinit, 1, get_average_R0)))
quantile(expit(pmcmc_param_chain_dgpinit[,3])/ expit(pmcmc_param_chain_dgpinit[,5]), probs = c(0.025,0.5,0.975))
get_confset(pmcmc_param_chain_dgpinit[nburn : nmcmc, 3])
get_average_R0(dgp_parameters)
get_confset(summary(apply(pmcmc_param_chain_dgpinit, 1, get_average_R0)))
get_confset(summary(apply(pmcmc_param_chain_dgpinit[nburn : nmcmc], 1, get_average_R0)))
get_confset(summary(apply(pmcmc_param_chain_dgpinit[nburn : nmcmc,], 1, get_average_R0)))
get_mean_sd(expit(pmcmc_param_chain_dgpinit[,3])/ expit(pmcmc_param_chain_dgpinit[,5]))
get_confset(pmcmc_param_chain_dgpinit[nburn : nmcmc, 1])
rm(list = ls())
dim(pmcmc_param_chain_dgpinit)
load("data_run_pmcmc_final.RData");
pmcmc_accept_chain_dgpinit <- accept_chain;
pmcmc_lpost_chain_dgpinit <- lpost_chain;
pmcmc_param_chain_dgpinit <- chain;
dim(pmcmc_param_chain_dgpinit)
nmcmc
nburn <- burn_in;
nmcmc <- num_mcmc;
get_confset <- function(vec){
quantile(vec, probs = c(0.025, 0.5,0.975));
}
get_mean_sd <- function(vec){
vec <- vec[!is.na(vec)];
c(mean(vec) - 2 *  sd(vec), mean(vec), mean(vec) + 2 * sd(vec));
}
for(id in 1 : 7){
cat("dgp is ", dgp_parameters[id],"\n");
cat(get_confset(pmcmc_param_chain_dgpinit[nburn : nmcmc, id]));
}
for(id in 1 : 7){
cat("dgp is ", dgp_parameters[id],"\n");
cat(get_confset(pmcmc_param_chain_dgpinit[nburn : nmcmc, id]), "\n");
}
expit <- function(x) 1 / (1 + exp(-x));
## get average of individual r0
get_average_R0 <- function(parameters){
b <- get_lambda(parameters[3], parameters[4]);
g <- get_lambda(parameters[5], parameters[6]);
median(b / g)
}
summary(apply(pmcmc_param_chain_dgpinit[nburn : nmcmc], 1, get_average_R0))
summary(apply(pmcmc_param_chain_dgpinit[nburn : nmcmc], 1, get_average_R0))
summary(apply(pmcmc_param_chain_dgpinit[nburn : nmcmc,], 1, get_average_R0))
get_average_R0(dgp_parameters)
average_R0_chain <- apply(pmcmc_param_chain_dgpinit[nburn : nmcmc,], 1, get_average_R0)
summary(average_R0_chain)
get_confset(average_R0_chain)
average_R0_chain <- apply(pmcmc_param_chain_dgpinit[nburn : nmcmc,], 1, get_average_R0)
summary(average_R0_chain)
get_confset(average_R0_chain)
get_average_R0(dgp_parameters)
get_r0_quantile <- function(parameters){
b <- get_lambda(parameters[3], parameters[4]);
g <- get_lambda(parameters[5], parameters[6]);
quantile(b / g, probs = c(0.25,0.75))
}
get_r0_quantile <- function(parameters){
b <- get_lambda(parameters[3], parameters[4]);
g <- get_lambda(parameters[5], parameters[6]);
quantile(b / g, probs = c(0.25,0.75))
}
quantile_R0_chain <- apply(pmcmc_param_chain_dgpinit[nburn : nmcmc,], 1, get_r0_quantile)
summary(quantile_R0_chain)
get_confset(quantile_R0_chain);
quantile_R0_chain <- apply(pmcmc_param_chain_dgpinit[nburn : nmcmc,], 1, get_r0_quantile)
summary(quantile_R0_chain)
get_confset(quantile_R0_chain);
get_confset(quantile_R0_chain);
get_r0_quantile(dgp_parameters)
get_r0_1stquart <- function(parameters){
b <- get_lambda(parameters[3], parameters[4]);
g <- get_lambda(parameters[5], parameters[6]);
quantile(b / g, probs = 0.25)
}
get_r0_1stquart(dgp_parameters)
R0_1stquart_chain <- apply(pmcmc_param_chain_dgpinit[nburn : nmcmc,], 1, get_r0_1stquart)
summary(R0_1stquart_chain)
get_confset(RR0_1stquart_chain);
get_confset(R0_1stquart_chain);
summary(R0_1stquart_chain)
get_confset(R0_1stquart_chain);
get_r0_1stquart(dgp_parameters)
get_r0_3rdquart <- function(parameters){
b <- get_lambda(parameters[3], parameters[4]);
g <- get_lambda(parameters[5], parameters[6]);
quantile(b / g, probs = 0.75)
}
R0_3rdquart_chain <- apply(pmcmc_param_chain_dgpinit[nburn : nmcmc,], 1, get_r0_3rdquart)
summary(R0_3rdquart_chain)
get_confset(R0_3rdquart_chain);
get_r0_3rdquart(dgp_parameters)
average_R0_chain <- apply(pmcmc_param_chain_dgpinit[nburn : nmcmc,], 1, get_average_R0)
summary(average_R0_chain)
get_confset(average_R0_chain)
get_average_R0(dgp_parameters)
summary(R0_3rdquart_chain)
get_confset(R0_3rdquart_chain);
get_r0_3rdquart(dgp_parameters)
get_confset(average_R0_chain)
